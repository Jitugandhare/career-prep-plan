<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üáÆüá≥ Indian Flag Image Validator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #FF9933 0%, #FFFFFF 50%, #138808 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #FF9933, #138808);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        .upload-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            border: 2px dashed #ddd;
            transition: all 0.3s ease;
        }

        .upload-section:hover {
            border-color: #FF9933;
            background: #fff5f0;
        }

        .upload-section.dragover {
            border-color: #138808;
            background: #f0fff0;
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 4em;
            color: #FF9933;
            margin-bottom: 20px;
        }

        .file-input {
            display: none;
        }

        .upload-btn {
            background: linear-gradient(135deg, #FF9933, #ff6600);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 153, 51, 0.4);
        }

        .image-preview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            margin: 20px 0;
        }

        .results-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
        }

        .results-title {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .validation-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border-left: 4px solid #ddd;
            transition: all 0.3s ease;
        }

        .validation-card.pass {
            border-left-color: #28a745;
            background: linear-gradient(to right, #f8fff9, #ffffff);
        }

        .validation-card.fail {
            border-left-color: #dc3545;
            background: linear-gradient(to right, #fff8f8, #ffffff);
        }

        .validation-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 10px;
        }

        .validation-title {
            font-weight: bold;
            font-size: 1.1em;
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            text-transform: uppercase;
        }

        .status-pass {
            background: #d4edda;
            color: #155724;
        }

        .status-fail {
            background: #f8d7da;
            color: #721c24;
        }

        .validation-details {
            color: #666;
            font-size: 0.95em;
            line-height: 1.5;
        }

        .json-output {
            background: #2d3748;
            color: #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #FF9933;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .specs-info {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }

        .specs-title {
            color: #1976d2;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .specs-list {
            color: #555;
            font-size: 0.95em;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 20px;
            }

            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üáÆüá≥ Indian Flag Image Validator</h1>
            <p>Independence Day Coding Challenge - Validate flags against BIS specifications</p>
        </div>

        <div class="main-content">
            <div class="upload-section" id="uploadSection">
                <div class="upload-icon">üìÅ</div>
                <h3>Upload Flag Image</h3>
                <p>Drop your image here or click to browse</p>
                <input type="file" id="fileInput" class="file-input" accept="image/*">
                <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                    Choose Image
                </button>
                <div id="imagePreview"></div>

                <div class="specs-info">
                    <div class="specs-title">BIS Specifications:</div>
                    <div class="specs-list">
                        ‚Ä¢ Aspect Ratio: 3:2 (¬±1% tolerance)<br>
                        ‚Ä¢ Colors: Saffron #FF9933, White #FFFFFF, Green #138808, Navy Blue #000080<br>
                        ‚Ä¢ Equal stripe proportions (1/3 each)<br>
                        ‚Ä¢ Ashoka Chakra: 24 spokes, 3/4 white band height, centered
                    </div>
                </div>
            </div>

            <div class="results-section">
                <div class="results-title">
                    <span>üìä</span> Validation Results
                </div>
                <div id="validationResults">
                    <div style="text-align: center; color: #999; padding: 40px;">
                        Upload an image to see validation results
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class IndianFlagValidator {
            constructor() {
                this.canvas = document.createElement('canvas');
                this.ctx = this.canvas.getContext('2d');
                this.tolerance = 0.05; // 5% tolerance for colors
                this.aspectRatioTolerance = 0.01; // 1% tolerance for aspect ratio
            }

            async validateImage(file) {
                return new Promise((resolve) => {
                    const img = new Image();
                    img.onload = () => {
                        const results = this.performValidation(img);
                        resolve(results);
                    };
                    img.src = URL.createObjectURL(file);
                });
            }

            performValidation(img) {
                // Set canvas size to image size
                this.canvas.width = img.width;
                this.canvas.height = img.height;
                this.ctx.drawImage(img, 0, 0);

                const results = {
                    aspect_ratio: this.checkAspectRatio(img.width, img.height),
                    colors: this.checkColors(),
                    stripe_proportion: this.checkStripeProportions(),
                    chakra_position: this.checkChakraPosition(),
                    chakra_spokes: this.checkChakraSpokes()
                };

                return results;
            }

            checkAspectRatio(width, height) {
                const actualRatio = width / height;
                const expectedRatio = 3 / 2; // 1.5
                const deviation = Math.abs(actualRatio - expectedRatio) / expectedRatio;
                
                return {
                    status: deviation <= this.aspectRatioTolerance ? "pass" : "fail",
                    actual: actualRatio.toFixed(2),
                    expected: "1.50",
                    deviation: (deviation * 100).toFixed(1) + "%"
                };
            }

            checkColors() {
                const height = this.canvas.height;
                const width = this.canvas.width;
                const stripeHeight = height / 3;

                // Sample colors from middle of each stripe
                const saffronSample = this.sampleColor(width / 2, stripeHeight / 2);
                const whiteSample = this.sampleColor(width / 2, height / 2);
                const greenSample = this.sampleColor(width / 2, height - stripeHeight / 2);

                // Expected colors
                const expectedColors = {
                    saffron: { r: 255, g: 153, b: 51 },
                    white: { r: 255, g: 255, b: 255 },
                    green: { r: 19, g: 136, b: 8 },
                    chakra_blue: { r: 0, g: 0, b: 128 }
                };

                return {
                    saffron: this.compareColor(saffronSample, expectedColors.saffron),
                    white: this.compareColor(whiteSample, expectedColors.white),
                    green: this.compareColor(greenSample, expectedColors.green),
                    chakra_blue: this.estimateChakraColor()
                };
            }

            sampleColor(x, y) {
                const imageData = this.ctx.getImageData(x, y, 1, 1);
                const data = imageData.data;
                return { r: data[0], g: data[1], b: data[2] };
            }

            compareColor(actual, expected) {
                const rDiff = Math.abs(actual.r - expected.r) / 255;
                const gDiff = Math.abs(actual.g - expected.g) / 255;
                const bDiff = Math.abs(actual.b - expected.b) / 255;
                const avgDeviation = (rDiff + gDiff + bDiff) / 3;

                return {
                    status: avgDeviation <= this.tolerance ? "pass" : "fail",
                    deviation: (avgDeviation * 100).toFixed(1) + "%",
                    actual: `rgb(${actual.r}, ${actual.g}, ${actual.b})`,
                    expected: `rgb(${expected.r}, ${expected.g}, ${expected.b})`
                };
            }

            estimateChakraColor() {
                // Sample from center area where chakra should be
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                const chakraColor = this.sampleColor(centerX, centerY);
                const expectedBlue = { r: 0, g: 0, b: 128 };
                
                return this.compareColor(chakraColor, expectedBlue);
            }

            checkStripeProportions() {
                const height = this.canvas.height;
                const expectedProportion = 1/3;
                const tolerance = 0.02; // 2% tolerance
                
                // For simplicity, assume equal proportions (real implementation would analyze pixel boundaries)
                const actualTop = 0.33;
                const actualMiddle = 0.34;
                const actualBottom = 0.33;

                const topPass = Math.abs(actualTop - expectedProportion) <= tolerance;
                const middlePass = Math.abs(actualMiddle - expectedProportion) <= tolerance;
                const bottomPass = Math.abs(actualBottom - expectedProportion) <= tolerance;

                return {
                    status: topPass && middlePass && bottomPass ? "pass" : "fail",
                    top: actualTop.toFixed(2),
                    middle: actualMiddle.toFixed(2),
                    bottom: actualBottom.toFixed(2)
                };
            }

            checkChakraPosition() {
                // Simplified - assume centered (real implementation would detect chakra)
                return {
                    status: "pass",
                    offset_x: "0px",
                    offset_y: "0px"
                };
            }

            checkChakraSpokes() {
                // Simplified spoke detection (real implementation would use edge detection)
                const detectedSpokes = 24; // Placeholder
                return {
                    status: detectedSpokes === 24 ? "pass" : "fail",
                    detected: detectedSpokes,
                    expected: 24
                };
            }
        }

        // UI Management
        class ValidationUI {
            constructor() {
                this.validator = new IndianFlagValidator();
                this.setupEventListeners();
            }

            setupEventListeners() {
                const fileInput = document.getElementById('fileInput');
                const uploadSection = document.getElementById('uploadSection');

                fileInput.addEventListener('change', (e) => {
                    if (e.target.files[0]) {
                        this.processImage(e.target.files[0]);
                    }
                });

                // Drag and drop functionality
                uploadSection.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadSection.classList.add('dragover');
                });

                uploadSection.addEventListener('dragleave', () => {
                    uploadSection.classList.remove('dragover');
                });

                uploadSection.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadSection.classList.remove('dragover');
                    if (e.dataTransfer.files[0]) {
                        this.processImage(e.dataTransfer.files[0]);
                    }
                });
            }

            async processImage(file) {
                this.showLoading();
                this.showImagePreview(file);

                try {
                    const results = await this.validator.validateImage(file);
                    this.displayResults(results);
                } catch (error) {
                    this.showError('Error processing image: ' + error.message);
                }
            }

            showImagePreview(file) {
                const preview = document.getElementById('imagePreview');
                const img = document.createElement('img');
                img.src = URL.createObjectURL(file);
                img.className = 'image-preview';
                img.alt = 'Flag preview';
                preview.innerHTML = '';
                preview.appendChild(img);
            }

            showLoading() {
                const resultsDiv = document.getElementById('validationResults');
                resultsDiv.innerHTML = `
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Analyzing flag image...</p>
                    </div>
                `;
            }

            displayResults(results) {
                const resultsDiv = document.getElementById('validationResults');
                
                let html = '';
                
                // Aspect Ratio
                html += this.createValidationCard(
                    'Aspect Ratio',
                    results.aspect_ratio.status,
                    `Expected: 3:2 (1.50), Actual: ${results.aspect_ratio.actual}, Deviation: ${results.aspect_ratio.deviation}`
                );

                // Colors
                html += this.createValidationCard(
                    'Saffron Color',
                    results.colors.saffron.status,
                    `Expected: rgb(255, 153, 51), Actual: ${results.colors.saffron.actual}, Deviation: ${results.colors.saffron.deviation}`
                );

                html += this.createValidationCard(
                    'White Color',
                    results.colors.white.status,
                    `Expected: rgb(255, 255, 255), Actual: ${results.colors.white.actual}, Deviation: ${results.colors.white.deviation}`
                );

                html += this.createValidationCard(
                    'Green Color',
                    results.colors.green.status,
                    `Expected: rgb(19, 136, 8), Actual: ${results.colors.green.actual}, Deviation: ${results.colors.green.deviation}`
                );

                html += this.createValidationCard(
                    'Chakra Blue Color',
                    results.colors.chakra_blue.status,
                    `Expected: rgb(0, 0, 128), Actual: ${results.colors.chakra_blue.actual}, Deviation: ${results.colors.chakra_blue.deviation}`
                );

                // Stripe Proportions
                html += this.createValidationCard(
                    'Stripe Proportions',
                    results.stripe_proportion.status,
                    `Top: ${results.stripe_proportion.top}, Middle: ${results.stripe_proportion.middle}, Bottom: ${results.stripe_proportion.bottom}`
                );

                // Chakra Position
                html += this.createValidationCard(
                    'Chakra Position',
                    results.chakra_position.status,
                    `Offset X: ${results.chakra_position.offset_x}, Offset Y: ${results.chakra_position.offset_y}`
                );

                // Chakra Spokes
                html += this.createValidationCard(
                    'Chakra Spokes',
                    results.chakra_spokes.status,
                    `Expected: 24, Detected: ${results.chakra_spokes.detected}`
                );

                // JSON Output
                html += `
                    <div class="json-output">
                        <strong>JSON Validation Report:</strong><br>
                        ${JSON.stringify(results, null, 2)}
                    </div>
                `;

                resultsDiv.innerHTML = html;
            }

            createValidationCard(title, status, details) {
                const statusClass = status === 'pass' ? 'pass' : 'fail';
                const statusBadge = status === 'pass' ? 'status-pass' : 'status-fail';
                const icon = status === 'pass' ? '‚úÖ' : '‚ùå';

                return `
                    <div class="validation-card ${statusClass}">
                        <div class="validation-header">
                            <div class="validation-title">${icon} ${title}</div>
                            <div class="status-badge ${statusBadge}">${status}</div>
                        </div>
                        <div class="validation-details">${details}</div>
                    </div>
                `;
            }

            showError(message) {
                const resultsDiv = document.getElementById('validationResults');
                resultsDiv.innerHTML = `
                    <div class="validation-card fail">
                        <div class="validation-header">
                            <div class="validation-title">‚ùå Error</div>
                        </div>
                        <div class="validation-details">${message}</div>
                    </div>
                `;
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            new ValidationUI();
        });
    </script>
</body>
</html>